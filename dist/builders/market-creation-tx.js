/**
 * Market Creation Transaction Builders
 *
 * Builds unsigned transactions for:
 * - create_lab_market_sol (community markets)
 * - create_private_table_sol (invite-only markets)
 * - create_race_market_sol (multi-outcome markets)
 *
 * FIXED: Jan 2026 - Corrected discriminators, offsets, and instruction formats
 */
import { Connection, PublicKey, Transaction, TransactionInstruction, SystemProgram, } from '@solana/web3.js';
import { PROGRAM_ID, CONFIG_PDA, CONFIG_TREASURY, SEEDS, RPC_ENDPOINT, } from '../config.js';
// =============================================================================
// INSTRUCTION DISCRIMINATORS (sha256("global:<name>")[0..8])
// =============================================================================
const CREATE_LAB_MARKET_SOL_DISCRIMINATOR = Buffer.from([35, 159, 50, 67, 31, 134, 199, 157]);
const CREATE_PRIVATE_TABLE_SOL_DISCRIMINATOR = Buffer.from([242, 241, 183, 108, 35, 183, 38, 241]);
const CREATE_RACE_MARKET_SOL_DISCRIMINATOR = Buffer.from([94, 237, 40, 47, 63, 233, 25, 67]);
// =============================================================================
// GLOBAL CONFIG OFFSETS (calculated from IDL struct layout)
// =============================================================================
// GlobalConfig struct layout:
// discriminator (8) + admin (32) + treasury (32) + guardian (32) +
// _reserved_usdc_mint (32) + _reserved_creation_fee_usdc (8) + creation_fee_sol (8) +
// _reserved_market_bond_usdc (8) + market_bond_sol (8) + platform_fee_bps (2) + market_count (8)
const MARKET_COUNT_OFFSET = 8 + 32 + 32 + 32 + 32 + 8 + 8 + 8 + 8 + 2; // = 170
// =============================================================================
// PDA DERIVATION
// =============================================================================
function deriveMarketPda(marketId) {
    const marketIdBuffer = Buffer.alloc(8);
    marketIdBuffer.writeBigUInt64LE(marketId);
    return PublicKey.findProgramAddressSync([SEEDS.MARKET, marketIdBuffer], PROGRAM_ID);
}
function deriveRaceMarketPda(marketId) {
    const marketIdBuffer = Buffer.alloc(8);
    marketIdBuffer.writeBigUInt64LE(marketId);
    return PublicKey.findProgramAddressSync([SEEDS.RACE, marketIdBuffer], PROGRAM_ID);
}
function deriveWhitelistPda(marketId) {
    const marketIdBuffer = Buffer.alloc(8);
    marketIdBuffer.writeBigUInt64LE(marketId);
    return PublicKey.findProgramAddressSync([SEEDS.WHITELIST, marketIdBuffer], PROGRAM_ID);
}
function deriveCreatorProfilePda(creator) {
    return PublicKey.findProgramAddressSync([Buffer.from('creator_profile'), creator.toBuffer()], PROGRAM_ID);
}
// =============================================================================
// GET MARKET COUNT FROM CONFIG
// =============================================================================
export async function getNextMarketId(connection) {
    const conn = connection || new Connection(RPC_ENDPOINT, 'confirmed');
    try {
        const configAccount = await conn.getAccountInfo(CONFIG_PDA);
        if (!configAccount) {
            throw new Error('GlobalConfig not found');
        }
        const data = configAccount.data;
        // market_count at offset 170 (verified against on-chain data)
        const marketCount = data.readBigUInt64LE(MARKET_COUNT_OFFSET);
        // Both regular and race markets use the SAME counter
        // The program uses the CURRENT value (not +1) for PDA derivation
        return {
            marketId: marketCount,
            raceMarketId: marketCount,
        };
    }
    catch (err) {
        // If we can't read config, return safe defaults
        return { marketId: 0n, raceMarketId: 0n };
    }
}
// =============================================================================
// BUILD CREATE LAB MARKET TRANSACTION
// =============================================================================
export async function buildCreateLabMarketTransaction(params, connection) {
    const conn = connection || new Connection(RPC_ENDPOINT, 'confirmed');
    const creatorPubkey = new PublicKey(params.creatorWallet);
    // Get current market count for PDA derivation
    const { marketId } = await getNextMarketId(conn);
    const [marketPda] = deriveMarketPda(marketId);
    const [creatorProfilePda] = deriveCreatorProfilePda(creatorPubkey);
    // Check if creator profile exists
    const creatorProfileInfo = await conn.getAccountInfo(creatorProfilePda);
    const hasCreatorProfile = creatorProfileInfo !== null;
    // Set defaults
    const closingTime = BigInt(Math.floor(params.closingTime.getTime() / 1000));
    const resolutionBuffer = BigInt(params.resolutionBuffer ?? 43200); // 12 hours
    const autoStopBuffer = BigInt(params.autoStopBuffer ?? 300); // 5 minutes
    const resolutionMode = params.resolutionMode ?? 1; // CouncilOracle by default
    // For CouncilOracle, creator is default council member
    const council = params.council?.map(p => new PublicKey(p)) ??
        (resolutionMode === 1 ? [creatorPubkey] : []);
    const councilThreshold = params.councilThreshold ?? (council.length > 0 ? 1 : 0);
    // Encode instruction data:
    // discriminator (8) + question (4+len) + closing_time (8) + resolution_buffer (8) +
    // auto_stop_buffer (8) + resolution_mode (1) + council (4+n*32) + council_threshold (1)
    const questionBytes = Buffer.from(params.question, 'utf8');
    const size = 8 + 4 + questionBytes.length + 8 + 8 + 8 + 1 + 4 + (council.length * 32) + 1;
    const data = Buffer.alloc(size);
    let offset = 0;
    CREATE_LAB_MARKET_SOL_DISCRIMINATOR.copy(data, offset);
    offset += 8;
    data.writeUInt32LE(questionBytes.length, offset);
    offset += 4;
    questionBytes.copy(data, offset);
    offset += questionBytes.length;
    data.writeBigInt64LE(closingTime, offset);
    offset += 8;
    data.writeBigInt64LE(resolutionBuffer, offset);
    offset += 8;
    data.writeBigInt64LE(autoStopBuffer, offset);
    offset += 8;
    data.writeUInt8(resolutionMode, offset);
    offset += 1;
    data.writeUInt32LE(council.length, offset);
    offset += 4;
    for (const member of council) {
        member.toBuffer().copy(data, offset);
        offset += 32;
    }
    data.writeUInt8(councilThreshold, offset);
    // Accounts from IDL:
    // config (PDA), market (PDA), treasury, creator (signer), creator_profile (optional), system_program
    const keys = [
        { pubkey: CONFIG_PDA, isSigner: false, isWritable: true },
        { pubkey: marketPda, isSigner: false, isWritable: true },
        { pubkey: CONFIG_TREASURY, isSigner: false, isWritable: true },
        { pubkey: creatorPubkey, isSigner: true, isWritable: true },
        // For optional accounts, pass PROGRAM_ID as placeholder if not present
        { pubkey: hasCreatorProfile ? creatorProfilePda : PROGRAM_ID, isSigner: false, isWritable: hasCreatorProfile },
        { pubkey: SystemProgram.programId, isSigner: false, isWritable: false },
    ];
    const instruction = new TransactionInstruction({
        programId: PROGRAM_ID,
        keys,
        data,
    });
    const transaction = new Transaction();
    transaction.add(instruction);
    const { blockhash } = await conn.getLatestBlockhash('finalized');
    transaction.recentBlockhash = blockhash;
    transaction.feePayer = creatorPubkey;
    const serializedTx = transaction.serialize({
        requireAllSignatures: false,
        verifySignatures: false,
    }).toString('base64');
    return {
        transaction,
        serializedTx,
        marketPda: marketPda.toBase58(),
        marketId,
    };
}
// =============================================================================
// BUILD CREATE PRIVATE MARKET TRANSACTION
// =============================================================================
export async function buildCreatePrivateMarketTransaction(params, connection) {
    const conn = connection || new Connection(RPC_ENDPOINT, 'confirmed');
    const creatorPubkey = new PublicKey(params.creatorWallet);
    const { marketId } = await getNextMarketId(conn);
    const [marketPda] = deriveMarketPda(marketId);
    const [whitelistPda] = deriveWhitelistPda(marketId);
    const [creatorProfilePda] = deriveCreatorProfilePda(creatorPubkey);
    const creatorProfileInfo = await conn.getAccountInfo(creatorProfilePda);
    const hasCreatorProfile = creatorProfileInfo !== null;
    const closingTime = BigInt(Math.floor(params.closingTime.getTime() / 1000));
    const resolutionBuffer = BigInt(params.resolutionBuffer ?? 43200);
    const autoStopBuffer = BigInt(params.autoStopBuffer ?? 300);
    const resolutionMode = params.resolutionMode ?? 0; // HostOracle for private
    const council = params.council?.map(p => new PublicKey(p)) ?? [];
    const councilThreshold = params.councilThreshold ?? 0;
    // Same instruction format as Lab market
    const questionBytes = Buffer.from(params.question, 'utf8');
    const size = 8 + 4 + questionBytes.length + 8 + 8 + 8 + 1 + 4 + (council.length * 32) + 1;
    const data = Buffer.alloc(size);
    let offset = 0;
    CREATE_PRIVATE_TABLE_SOL_DISCRIMINATOR.copy(data, offset);
    offset += 8;
    data.writeUInt32LE(questionBytes.length, offset);
    offset += 4;
    questionBytes.copy(data, offset);
    offset += questionBytes.length;
    data.writeBigInt64LE(closingTime, offset);
    offset += 8;
    data.writeBigInt64LE(resolutionBuffer, offset);
    offset += 8;
    data.writeBigInt64LE(autoStopBuffer, offset);
    offset += 8;
    data.writeUInt8(resolutionMode, offset);
    offset += 1;
    data.writeUInt32LE(council.length, offset);
    offset += 4;
    for (const member of council) {
        member.toBuffer().copy(data, offset);
        offset += 32;
    }
    data.writeUInt8(councilThreshold, offset);
    // Private market accounts include whitelist PDA
    const keys = [
        { pubkey: CONFIG_PDA, isSigner: false, isWritable: true },
        { pubkey: marketPda, isSigner: false, isWritable: true },
        { pubkey: whitelistPda, isSigner: false, isWritable: true },
        { pubkey: CONFIG_TREASURY, isSigner: false, isWritable: true },
        { pubkey: creatorPubkey, isSigner: true, isWritable: true },
        { pubkey: hasCreatorProfile ? creatorProfilePda : PROGRAM_ID, isSigner: false, isWritable: hasCreatorProfile },
        { pubkey: SystemProgram.programId, isSigner: false, isWritable: false },
    ];
    const instruction = new TransactionInstruction({
        programId: PROGRAM_ID,
        keys,
        data,
    });
    const transaction = new Transaction();
    transaction.add(instruction);
    const { blockhash } = await conn.getLatestBlockhash('finalized');
    transaction.recentBlockhash = blockhash;
    transaction.feePayer = creatorPubkey;
    const serializedTx = transaction.serialize({
        requireAllSignatures: false,
        verifySignatures: false,
    }).toString('base64');
    return {
        transaction,
        serializedTx,
        marketPda: marketPda.toBase58(),
        marketId,
    };
}
// =============================================================================
// BUILD CREATE RACE MARKET TRANSACTION
// =============================================================================
export async function buildCreateRaceMarketTransaction(params, connection) {
    const conn = connection || new Connection(RPC_ENDPOINT, 'confirmed');
    const creatorPubkey = new PublicKey(params.creatorWallet);
    const { raceMarketId } = await getNextMarketId(conn);
    const [raceMarketPda] = deriveRaceMarketPda(raceMarketId);
    const [creatorProfilePda] = deriveCreatorProfilePda(creatorPubkey);
    const creatorProfileInfo = await conn.getAccountInfo(creatorProfilePda);
    const hasCreatorProfile = creatorProfileInfo !== null;
    const closingTime = BigInt(Math.floor(params.closingTime.getTime() / 1000));
    const resolutionBuffer = BigInt(params.resolutionBuffer ?? 43200);
    const autoStopBuffer = BigInt(params.autoStopBuffer ?? 300);
    const layer = params.layer ?? 1; // Lab by default
    const resolutionMode = params.resolutionMode ?? 1; // CouncilOracle
    const accessGate = params.accessGate ?? 0; // Public
    // Council is Option<Vec<Pubkey>> - encode as 1 (Some) + vec or 0 (None)
    const hasCouncil = params.council && params.council.length > 0;
    const council = hasCouncil ? params.council.map(p => new PublicKey(p)) : [];
    // council_threshold is Option<u8>
    const hasThreshold = params.councilThreshold !== undefined;
    const councilThreshold = params.councilThreshold ?? 0;
    // Encode instruction data:
    // discriminator (8) + question (4+len) + outcome_labels (4 + n*(4+len)) +
    // closing_time (8) + resolution_buffer (8) + auto_stop_buffer (8) +
    // layer (1) + resolution_mode (1) + access_gate (1) +
    // council (1 + 4 + n*32 or just 1) + council_threshold (1 + 1 or just 1)
    const questionBytes = Buffer.from(params.question, 'utf8');
    const outcomeBuffers = params.outcomes.map(o => Buffer.from(o, 'utf8'));
    let outcomesSize = 4; // vec length
    for (const buf of outcomeBuffers) {
        outcomesSize += 4 + buf.length;
    }
    const councilSize = hasCouncil ? (1 + 4 + council.length * 32) : 1;
    const thresholdSize = hasThreshold ? 2 : 1;
    const size = 8 + 4 + questionBytes.length + outcomesSize + 8 + 8 + 8 + 1 + 1 + 1 + councilSize + thresholdSize;
    const data = Buffer.alloc(size);
    let offset = 0;
    CREATE_RACE_MARKET_SOL_DISCRIMINATOR.copy(data, offset);
    offset += 8;
    data.writeUInt32LE(questionBytes.length, offset);
    offset += 4;
    questionBytes.copy(data, offset);
    offset += questionBytes.length;
    data.writeUInt32LE(params.outcomes.length, offset);
    offset += 4;
    for (const buf of outcomeBuffers) {
        data.writeUInt32LE(buf.length, offset);
        offset += 4;
        buf.copy(data, offset);
        offset += buf.length;
    }
    data.writeBigInt64LE(closingTime, offset);
    offset += 8;
    data.writeBigInt64LE(resolutionBuffer, offset);
    offset += 8;
    data.writeBigInt64LE(autoStopBuffer, offset);
    offset += 8;
    data.writeUInt8(layer, offset);
    offset += 1;
    data.writeUInt8(resolutionMode, offset);
    offset += 1;
    data.writeUInt8(accessGate, offset);
    offset += 1;
    // Option<Vec<Pubkey>> - 1 (Some) + vec or 0 (None)
    if (hasCouncil) {
        data.writeUInt8(1, offset);
        offset += 1;
        data.writeUInt32LE(council.length, offset);
        offset += 4;
        for (const member of council) {
            member.toBuffer().copy(data, offset);
            offset += 32;
        }
    }
    else {
        data.writeUInt8(0, offset);
        offset += 1;
    }
    // Option<u8> - 1 (Some) + value or 0 (None)
    if (hasThreshold) {
        data.writeUInt8(1, offset);
        offset += 1;
        data.writeUInt8(councilThreshold, offset);
        offset += 1;
    }
    else {
        data.writeUInt8(0, offset);
        offset += 1;
    }
    // Accounts: config, race_market, creator_profile (optional), treasury, creator, system_program
    const keys = [
        { pubkey: CONFIG_PDA, isSigner: false, isWritable: true },
        { pubkey: raceMarketPda, isSigner: false, isWritable: true },
        { pubkey: hasCreatorProfile ? creatorProfilePda : PROGRAM_ID, isSigner: false, isWritable: hasCreatorProfile },
        { pubkey: CONFIG_TREASURY, isSigner: false, isWritable: true },
        { pubkey: creatorPubkey, isSigner: true, isWritable: true },
        { pubkey: SystemProgram.programId, isSigner: false, isWritable: false },
    ];
    const instruction = new TransactionInstruction({
        programId: PROGRAM_ID,
        keys,
        data,
    });
    const transaction = new Transaction();
    transaction.add(instruction);
    const { blockhash } = await conn.getLatestBlockhash('finalized');
    transaction.recentBlockhash = blockhash;
    transaction.feePayer = creatorPubkey;
    const serializedTx = transaction.serialize({
        requireAllSignatures: false,
        verifySignatures: false,
    }).toString('base64');
    return {
        transaction,
        serializedTx,
        marketPda: raceMarketPda.toBase58(),
        marketId: raceMarketId,
    };
}
// =============================================================================
// HELPER: DERIVE PDA PREVIEW
// =============================================================================
export function previewMarketPda(marketId) {
    const [pda, bump] = deriveMarketPda(marketId);
    return { marketPda: pda.toBase58(), bump };
}
export function previewRaceMarketPda(marketId) {
    const [pda, bump] = deriveRaceMarketPda(marketId);
    return { raceMarketPda: pda.toBase58(), bump };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFya2V0LWNyZWF0aW9uLXR4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2J1aWxkZXJzL21hcmtldC1jcmVhdGlvbi10eC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0dBU0c7QUFDSCxPQUFPLEVBQ0wsVUFBVSxFQUNWLFNBQVMsRUFDVCxXQUFXLEVBQ1gsc0JBQXNCLEVBQ3RCLGFBQWEsR0FDZCxNQUFNLGlCQUFpQixDQUFDO0FBQ3pCLE9BQU8sRUFDTCxVQUFVLEVBQ1YsVUFBVSxFQUNWLGVBQWUsRUFDZixLQUFLLEVBQ0wsWUFBWSxHQUNiLE1BQU0sY0FBYyxDQUFDO0FBRXRCLGdGQUFnRjtBQUNoRiw2REFBNkQ7QUFDN0QsZ0ZBQWdGO0FBRWhGLE1BQU0sbUNBQW1DLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzlGLE1BQU0sc0NBQXNDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ25HLE1BQU0sb0NBQW9DLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBRTdGLGdGQUFnRjtBQUNoRiw0REFBNEQ7QUFDNUQsZ0ZBQWdGO0FBRWhGLDhCQUE4QjtBQUM5QixtRUFBbUU7QUFDbkUsc0ZBQXNGO0FBQ3RGLGlHQUFpRztBQUNqRyxNQUFNLG1CQUFtQixHQUFHLENBQUMsR0FBRyxF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QixnRkFBZ0Y7QUFFaEYsTUFBTSxVQUFVLGdCQUFnQixDQUFDLFFBQWdCO0lBSS9DLE1BQU0sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzlDLE9BQU8sRUFBRSxTQUFTLEVBQUUsR0FBRyxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDO0FBQzdDLENBQUM7QUFFRCxNQUFNLFVBQVUsb0JBQW9CLENBQUMsUUFBZ0I7SUFJbkQsTUFBTSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLEdBQUcsQ0FBQyxRQUFRLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUNqRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNYXJrZXQgQ3JlYXRpb24gVHJhbnNhY3Rpb24gQnVpbGRlcnNcbiAqXG4gKiBCdWlsZHMgdW5zaWduZWQgdHJhbnNhY3Rpb25zIGZvcjpcbiAqIC0gY3JlYXRlX2xhYl9tYXJrZXRfc29sIChjb21tdW5pdHkgbWFya2V0cylcbiAqIC0gY3JlYXRlX3ByaXZhdGVfdGFibGVfc29sIChpbnZpdGUtb25seSBtYXJrZXRzKVxuICogLSBjcmVhdGVfcmFjZV9tYXJrZXRfc29sIChtdWx0aS1vdXRjb21lIG1hcmtldHMpXG4gKlxuICogRklYRUQ6IEphbiAyMDI2IC0gQ29ycmVjdGVkIGRpc2NyaW1pbmF0b3JzLCBvZmZzZXRzLCBhbmQgaW5zdHJ1Y3Rpb24gZm9ybWF0c1xuICovXG5pbXBvcnQge1xuICBDb25uZWN0aW9uLFxuICBQdWJsaWNLZXksXG4gIFRyYW5zYWN0aW9uLFxuICBUcmFuc2FjdGlvbkluc3RydWN0aW9uLFxuICBTeXN0ZW1Qcm9ncmFtLFxufSBmcm9tICdAc29sYW5hL3dlYjMuanMnO1xuaW1wb3J0IHtcbiAgUFJPR1JBTV9JRCxcbiAgQ09ORklHX1BEQSxcbiAgQ09ORklHX1RSRUFTVVJZLFxuICBTRUVEUyxcbiAgUlBDX0VORFBPSU5ULFxufSBmcm9tICcuLi9jb25maWcuanMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSU5TVFJVQ1RJT04gRElTQ1JJTUlOQVRPUlMgKHNoYTI1NihcImdsb2JhbDo8bmFtZT5cIilbMC4uOF0pXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBDUkVBVEVfTEFCX01BUktFVF9TT0xfRElTQ1JJTUlOQVRPUiA9IEJ1ZmZlci5mcm9tKFszNSwgMTU5LCA1MCwgNjcsIDMxLCAxMzQsIDE5OSwgMTU3XSk7XG5jb25zdCBDUkVBVEVfUFJJVkFURV9UQUJMRV9TT0xfRElTQ1JJTUlOQVRPUiA9IEJ1ZmZlci5mcm9tKFsyNDIsIDI0MSwgMTgzLCAxMDgsIDM1LCAxODMsIDM4LCAyNDFdKTtcbmNvbnN0IENSRUFURV9SQUNFX01BUktFVF9TT0xfRElTQ1JJTUlOQVRPUiA9IEJ1ZmZlci5mcm9tKFs5NCwgMjM3LCA0MCwgNDcsIDYzLCAyMzMsIDI1LCA2N10pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0xPQkFMIENPTkZJRyBPRkZTRVRTIChjYWxjdWxhdGVkIGZyb20gSURMIHN0cnVjdCBsYXlvdXQpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyBHbG9iYWxDb25maWcgc3RydWN0IGxheW91dDpcbi8vIGRpc2NyaW1pbmF0b3IgKDgpICsgYWRtaW4gKDMyKSArIHRyZWFzdXJ5ICgzMikgKyBndWFyZGlhbiAoMzIpICtcbi8vIF9yZXNlcnZlZF91c2RjX21pbnQgKDMyKSArIF9yZXNlcnZlZF9jcmVhdGlvbl9mZWVfdXNkYyAoOCkgKyBjcmVhdGlvbl9mZWVfc29sICg4KSArXG4vLyBfcmVzZXJ2ZWRfbWFya2V0X2JvbmRfdXNkYyAoOCkgKyBtYXJrZXRfYm9uZF9zb2wgKDgpICsgcGxhdGZvcm1fZmVlX2JwcyAoMikgKyBtYXJrZXRfY291bnQgKDgpXG5jb25zdCBNQVJLRVRfQ09VTlRfT0ZGU0VUID0gOCArIDMyICsgMzIgKyAzMiArIDMyICsgOCArIDggKyA4ICsgOCArIDI7IC8vID0gMTcwXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUWVBFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVNYXJrZXRSZXN1bHQge1xuICB0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb247XG4gIHNlcmlhbGl6ZWRUeDogc3RyaW5nO1xuICBtYXJrZXRQZGE6IHN0cmluZztcbiAgbWFya2V0SWQ6IGJpZ2ludDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVMYWJNYXJrZXRQYXJhbXMge1xuICBxdWVzdGlvbjogc3RyaW5nO1xuICBjbG9zaW5nVGltZTogRGF0ZTtcbiAgcmVzb2x1dGlvbkJ1ZmZlcj86IG51bWJlcjsgICAgLy8gc2Vjb25kcyBhZnRlciBjbG9zaW5nIGJlZm9yZSByZXNvbHV0aW9uIChkZWZhdWx0OiA0MzIwMCA9IDEyaClcbiAgYXV0b1N0b3BCdWZmZXI/OiBudW1iZXI7ICAgICAgLy8gc2Vjb25kcyBiZWZvcmUgY2xvc2luZyB0byBzdG9wIGJldHRpbmcgKGRlZmF1bHQ6IDMwMCA9IDVtaW4pXG4gIHJlc29sdXRpb25Nb2RlPzogbnVtYmVyOyAgICAgIC8vIDA9SG9zdE9yYWNsZSwgMT1Db3VuY2lsT3JhY2xlIChkZWZhdWx0OiAxKVxuICBjb3VuY2lsPzogc3RyaW5nW107ICAgICAgICAgICAvLyBjb3VuY2lsIG1lbWJlciBwdWJrZXlzIChyZXF1aXJlZCBpZiByZXNvbHV0aW9uTW9kZT0xKVxuICBjb3VuY2lsVGhyZXNob2xkPzogbnVtYmVyOyAgICAvLyB2b3RlcyBuZWVkZWQgKHJlcXVpcmVkIGlmIHJlc29sdXRpb25Nb2RlPTEpXG4gIGNyZWF0b3JXYWxsZXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVQcml2YXRlTWFya2V0UGFyYW1zIHtcbiAgcXVlc3Rpb246IHN0cmluZztcbiAgY2xvc2luZ1RpbWU6IERhdGU7XG4gIHJlc29sdXRpb25CdWZmZXI/OiBudW1iZXI7XG4gIGF1dG9TdG9wQnVmZmVyPzogbnVtYmVyO1xuICByZXNvbHV0aW9uTW9kZT86IG51bWJlcjtcbiAgY291bmNpbD86IHN0cmluZ1tdO1xuICBjb3VuY2lsVGhyZXNob2xkPzogbnVtYmVyO1xuICBjcmVhdG9yV2FsbGV0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlUmFjZU1hcmtldFBhcmFtcyB7XG4gIHF1ZXN0aW9uOiBzdHJpbmc7XG4gIG91dGNvbWVzOiBzdHJpbmdbXTsgICAgICAgICAgIC8vIDItMTAgb3V0Y29tZSBsYWJlbHNcbiAgY2xvc2luZ1RpbWU6IERhdGU7XG4gIHJlc29sdXRpb25CdWZmZXI/OiBudW1iZXI7XG4gIGF1dG9TdG9wQnVmZmVyPzogbnVtYmVyO1xuICBsYXllcj86IG51bWJlcjsgICAgICAgICAgICAgICAvLyAxPUxhYiwgMj1Qcml2YXRlIChkZWZhdWx0OiAxKVxuICByZXNvbHV0aW9uTW9kZT86IG51bWJlcjsgICAgICAvLyAwPUhvc3RPcmFjbGUsIDE9Q291bmNpbE9yYWNsZVxuICBhY2Nlc3NHYXRlPzogbnVtYmVyOyAgICAgICAgICAvLyAwPVB1YmxpYywgMT1XaGl0ZWxpc3RcbiAgY291bmNpbD86IHN0cmluZ1tdO1xuICBjb3VuY2lsVGhyZXNob2xkPzogbnVtYmVyO1xuICBjcmVhdG9yV2FsbGV0OiBzdHJpbmc7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQREEgREVSSVZBVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gZGVyaXZlTWFya2V0UGRhKG1hcmtldElkOiBiaWdpbnQpOiBbUHVibGljS2V5LCBudW1iZXJdIHtcbiAgY29uc3QgbWFya2V0SWRCdWZmZXIgPSBCdWZmZXIuYWxsb2MoOCk7XG4gIG1hcmtldElkQnVmZmVyLndyaXRlQmlnVUludDY0TEUobWFya2V0SWQpO1xuICByZXR1cm4gUHVibGljS2V5LmZpbmRQcm9ncmFtQWRkcmVzc1N5bmMoXG4gICAgW1NFRURTLk1BUktFVCwgbWFya2V0SWRCdWZmZXJdLFxuICAgIFBST0dSQU1fSURcbiAgKTtcbn1cblxuZnVuY3Rpb24gZGVyaXZlUmFjZU1hcmtldFBkYShtYXJrZXRJZDogYmlnaW50KTogW1B1YmxpY0tleSwgbnVtYmVyXSB7XG4gIGNvbnN0IG1hcmtldElkQnVmZmVyID0gQnVmZmVyLmFsbG9jKDgpO1xuICBtYXJrZXRJZEJ1ZmZlci53cml0ZUJpZ1VJbnQ2NExFKG1hcmtldElkKTtcbiAgcmV0dXJuIFB1YmxpY0tleS5maW5kUHJvZ3JhbUFkZHJlc3NTeW5jKFxuICAgIFtTRUVEUy5SQUNFLCBtYXJrZXRJZEJ1ZmZlcl0sXG4gICAgUFJPR1JBTV9JRFxuICApO1xufVxuXG5mdW5jdGlvbiBkZXJpdmVXaGl0ZWxpc3RQZGEobWFya2V0SWQ6IGJpZ2ludCk6IFtQdWJsaWNLZXksIG51bWJlcl0ge1xuICBjb25zdCBtYXJrZXRJZEJ1ZmZlciA9IEJ1ZmZlci5hbGxvYyg4KTtcbiAgbWFya2V0SWRCdWZmZXIud3JpdGVCaWdVSW50NjRMRShtYXJrZXRJZCk7XG4gIHJldHVybiBQdWJsaWNLZXkuZmluZFByb2dyYW1BZGRyZXNzU3luYyhcbiAgICBbU0VFRFMuV0hJVEVMSVNULCBtYXJrZXRJZEJ1ZmZlcl0sXG4gICAgUFJPR1JBTV9JRFxuICApO1xufVxuXG5mdW5jdGlvbiBkZXJpdmVDcmVhdG9yUHJvZmlsZVBkYShjcmVhdG9yOiBQdWJsaWNLZXkpOiBbUHVibGljS2V5LCBudW1iZXJdIHtcbiAgcmV0dXJuIFB1YmxpY0tleS5maW5kUHJvZ3JhbUFkZHJlc3NTeW5jKFxuICAgIFtCdWZmZXIuZnJvbSgnY3JlYXRvcl9wcm9maWxlJyksIGNyZWF0b3IudG9CdWZmZXIoKV0sXG4gICAgUFJPR1JBTV9JRFxuICApO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VUIE1BUktFVCBDT1VOVCBGUk9NIENPTkZJR1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE5leHRNYXJrZXRJZChcbiAgY29ubmVjdGlvbj86IENvbm5lY3Rpb25cbik6IFByb21pc2U8eyBtYXJrZXRJZDogYmlnaW50OyByYWNlTWFya2V0SWQ6IGJpZ2ludCB9PiB7XG4gIGNvbnN0IGNvbm4gPSBjb25uZWN0aW9uIHx8IG5ldyBDb25uZWN0aW9uKFJQQ19FTkRQT0lOVCwgJ2NvbmZpcm1lZCcpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgY29uZmlnQWNjb3VudCA9IGF3YWl0IGNvbm4uZ2V0QWNjb3VudEluZm8oQ09ORklHX1BEQSk7XG4gICAgaWYgKCFjb25maWdBY2NvdW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dsb2JhbENvbmZpZyBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gY29uZmlnQWNjb3VudC5kYXRhO1xuICAgIC8vIG1hcmtldF9jb3VudCBhdCBvZmZzZXQgMTcwICh2ZXJpZmllZCBhZ2FpbnN0IG9uLWNoYWluIGRhdGEpXG4gICAgY29uc3QgbWFya2V0Q291bnQgPSBkYXRhLnJlYWRCaWdVSW50NjRMRShNQVJLRVRfQ09VTlRfT0ZGU0VUKTtcblxuICAgIC8vIEJvdGggcmVndWxhciBhbmQgcmFjZSBtYXJrZXRzIHVzZSB0aGUgU0FNRSBjb3VudGVyXG4gICAgLy8gVGhlIHByb2dyYW0gdXNlcyB0aGUgQ1VSUkVOVCB2YWx1ZSAobm90ICsxKSBmb3IgUERBIGRlcml2YXRpb25cbiAgICByZXR1cm4ge1xuICAgICAgbWFya2V0SWQ6IG1hcmtldENvdW50LFxuICAgICAgcmFjZU1hcmtldElkOiBtYXJrZXRDb3VudCxcbiAgICB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBJZiB3ZSBjYW4ndCByZWFkIGNvbmZpZywgcmV0dXJuIHNhZmUgZGVmYXVsdHNcbiAgICByZXR1cm4geyBtYXJrZXRJZDogMG4sIHJhY2VNYXJrZXRJZDogMG4gfTtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQlVJTEQgQ1JFQVRFIExBQiBNQVJLRVQgVFJBTlNBQ1RJT05cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZENyZWF0ZUxhYk1hcmtldFRyYW5zYWN0aW9uKFxuICBwYXJhbXM6IENyZWF0ZUxhYk1hcmtldFBhcmFtcyxcbiAgY29ubmVjdGlvbj86IENvbm5lY3Rpb25cbik6IFByb21pc2U8Q3JlYXRlTWFya2V0UmVzdWx0PiB7XG4gIGNvbnN0IGNvbm4gPSBjb25uZWN0aW9uIHx8IG5ldyBDb25uZWN0aW9uKFJQQ19FTkRQT0lOVCwgJ2NvbmZpcm1lZCcpO1xuICBjb25zdCBjcmVhdG9yUHVia2V5ID0gbmV3IFB1YmxpY0tleShwYXJhbXMuY3JlYXRvcldhbGxldCk7XG5cbiAgLy8gR2V0IGN1cnJlbnQgbWFya2V0IGNvdW50IGZvciBQREEgZGVyaXZhdGlvblxuICBjb25zdCB7IG1hcmtldElkIH0gPSBhd2FpdCBnZXROZXh0TWFya2V0SWQoY29ubik7XG4gIGNvbnN0IFttYXJrZXRQZGFdID0gZGVyaXZlTWFya2V0UGRhKG1hcmtldElkKTtcbiAgY29uc3QgW2NyZWF0b3JQcm9maWxlUGRhXSA9IGRlcml2ZUNyZWF0b3JQcm9maWxlUGRhKGNyZWF0b3JQdWJrZXkpO1xuXG4gIC8vIENoZWNrIGlmIGNyZWF0b3IgcHJvZmlsZSBleGlzdHNcbiAgY29uc3QgY3JlYXRvclByb2ZpbGVJbmZvID0gYXdhaXQgY29ubi5nZXRBY2NvdW50SW5mbyhjcmVhdG9yUHJvZmlsZVBkYSk7XG4gIGNvbnN0IGhhc0NyZWF0b3JQcm9maWxlID0gY3JlYXRvclByb2ZpbGVJbmZvICE9PSBudWxsO1xuXG4gIC8vIFNldCBkZWZhdWx0c1xuICBjb25zdCBjbG9zaW5nVGltZSA9IEJpZ0ludChNYXRoLmZsb29yKHBhcmFtcy5jbG9zaW5nVGltZS5nZXRUaW1lKCkgLyAxMDAwKSk7XG4gIGNvbnN0IHJlc29sdXRpb25CdWZmZXIgPSBCaWdJbnQocGFyYW1zLnJlc29sdXRpb25CdWZmZXIgPz8gNDMyMDApOyAvLyAxMiBob3Vyc1xuICBjb25zdCBhdXRvU3RvcEJ1ZmZlciA9IEJpZ0ludChwYXJhbXMuYXV0b1N0b3BCdWZmZXIgPz8gMzAwKTsgLy8gNSBtaW51dGVzXG4gIGNvbnN0IHJlc29sdXRpb25Nb2RlID0gcGFyYW1zLnJlc29sdXRpb25Nb2RlID8/IDE7IC8vIENvdW5jaWxPcmFjbGUgYnkgZGVmYXVsdFxuXG4gIC8vIEZvciBDb3VuY2lsT3JhY2xlLCBjcmVhdG9yIGlzIGRlZmF1bHQgY291bmNpbCBtZW1iZXJcbiAgY29uc3QgY291bmNpbCA9IHBhcmFtcy5jb3VuY2lsPy5tYXAocCA9PiBuZXcgUHVibGljS2V5KHApKSA/P1xuICAgIChyZXNvbHV0aW9uTW9kZSA9PT0gMSA/IFtjcmVhdG9yUHVia2V5XSA6IFtdKTtcbiAgY29uc3QgY291bmNpbFRocmVzaG9sZCA9IHBhcmFtcy5jb3VuY2lsVGhyZXNob2xkID8/IChjb3VuY2lsLmxlbmd0aCA+IDAgPyAxIDogMCk7XG5cbiAgLy8gRW5jb2RlIGluc3RydWN0aW9uIGRhdGE6XG4gIC8vIGRpc2NyaW1pbmF0b3IgKDgpICsgcXVlc3Rpb24gKDQrbGVuKSArIGNsb3NpbmdfdGltZSAoOCkgKyByZXNvbHV0aW9uX2J1ZmZlciAoOCkgK1xuICAvLyBhdXRvX3N0b3BfYnVmZmVyICg4KSArIHJlc29sdXRpb25fbW9kZSAoMSkgKyBjb3VuY2lsICg0K24qMzIpICsgY291bmNpbF90aHJlc2hvbGQgKDEpXG4gIGNvbnN0IHF1ZXN0aW9uQnl0ZXMgPSBCdWZmZXIuZnJvbShwYXJhbXMucXVlc3Rpb24sICd1dGY4Jyk7XG4gIGNvbnN0IHNpemUgPSA4ICsgNCArIHF1ZXN0aW9uQnl0ZXMubGVuZ3RoICsgOCArIDggKyA4ICsgMSArIDQgKyAoY291bmNpbC5sZW5ndGggKiAzMikgKyAxO1xuXG4gIGNvbnN0IGRhdGEgPSBCdWZmZXIuYWxsb2Moc2l6ZSk7XG4gIGxldCBvZmZzZXQgPSAwO1xuXG4gIENSRUFURV9MQUJfTUFSS0VUX1NPTF9ESVNDUklNSU5BVE9SLmNvcHkoZGF0YSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDg7XG4gIGRhdGEud3JpdGVVSW50MzJMRShxdWVzdGlvbkJ5dGVzLmxlbmd0aCwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDQ7XG4gIHF1ZXN0aW9uQnl0ZXMuY29weShkYXRhLCBvZmZzZXQpOyBvZmZzZXQgKz0gcXVlc3Rpb25CeXRlcy5sZW5ndGg7XG4gIGRhdGEud3JpdGVCaWdJbnQ2NExFKGNsb3NpbmdUaW1lLCBvZmZzZXQpOyBvZmZzZXQgKz0gODtcbiAgZGF0YS53cml0ZUJpZ0ludDY0TEUocmVzb2x1dGlvbkJ1ZmZlciwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDg7XG4gIGRhdGEud3JpdGVCaWdJbnQ2NExFKGF1dG9TdG9wQnVmZmVyLCBvZmZzZXQpOyBvZmZzZXQgKz0gODtcbiAgZGF0YS53cml0ZVVJbnQ4KHJlc29sdXRpb25Nb2RlLCBvZmZzZXQpOyBvZmZzZXQgKz0gMTtcbiAgZGF0YS53cml0ZVVJbnQzMkxFKGNvdW5jaWwubGVuZ3RoLCBvZmZzZXQpOyBvZmZzZXQgKz0gNDtcbiAgZm9yIChjb25zdCBtZW1iZXIgb2YgY291bmNpbCkge1xuICAgIG1lbWJlci50b0J1ZmZlcigpLmNvcHkoZGF0YSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDMyO1xuICB9XG4gIGRhdGEud3JpdGVVSW50OChjb3VuY2lsVGhyZXNob2xkLCBvZmZzZXQpO1xuXG4gIC8vIEFjY291bnRzIGZyb20gSURMOlxuICAvLyBjb25maWcgKFBEQSksIG1hcmtldCAoUERBKSwgdHJlYXN1cnksIGNyZWF0b3IgKHNpZ25lciksIGNyZWF0b3JfcHJvZmlsZSAob3B0aW9uYWwpLCBzeXN0ZW1fcHJvZ3JhbVxuICBjb25zdCBrZXlzID0gW1xuICAgIHsgcHVia2V5OiBDT05GSUdfUERBLCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IHRydWUgfSxcbiAgICB7IHB1YmtleTogbWFya2V0UGRhLCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IHRydWUgfSxcbiAgICB7IHB1YmtleTogQ09ORklHX1RSRUFTVVJZLCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IHRydWUgfSxcbiAgICB7IHB1YmtleTogY3JlYXRvclB1YmtleSwgaXNTaWduZXI6IHRydWUsIGlzV3JpdGFibGU6IHRydWUgfSxcbiAgICAvLyBGb3Igb3B0aW9uYWwgYWNjb3VudHMsIHBhc3MgUFJPR1JBTV9JRCBhcyBwbGFjZWhvbGRlciBpZiBub3QgcHJlc2VudFxuICAgIHsgcHVia2V5OiBoYXNDcmVhdG9yUHJvZmlsZSA/IGNyZWF0b3JQcm9maWxlUGRhIDogUFJPR1JBTV9JRCwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiBoYXNDcmVhdG9yUHJvZmlsZSB9LFxuICAgIHsgcHVia2V5OiBTeXN0ZW1Qcm9ncmFtLnByb2dyYW1JZCwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiBmYWxzZSB9LFxuICBdO1xuXG4gIGNvbnN0IGluc3RydWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uSW5zdHJ1Y3Rpb24oe1xuICAgIHByb2dyYW1JZDogUFJPR1JBTV9JRCxcbiAgICBrZXlzLFxuICAgIGRhdGEsXG4gIH0pO1xuXG4gIGNvbnN0IHRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKCk7XG4gIHRyYW5zYWN0aW9uLmFkZChpbnN0cnVjdGlvbik7XG5cbiAgY29uc3QgeyBibG9ja2hhc2ggfSA9IGF3YWl0IGNvbm4uZ2V0TGF0ZXN0QmxvY2toYXNoKCdmaW5hbGl6ZWQnKTtcbiAgdHJhbnNhY3Rpb24ucmVjZW50QmxvY2toYXNoID0gYmxvY2toYXNoO1xuICB0cmFuc2FjdGlvbi5mZWVQYXllciA9IGNyZWF0b3JQdWJrZXk7XG5cbiAgY29uc3Qgc2VyaWFsaXplZFR4ID0gdHJhbnNhY3Rpb24uc2VyaWFsaXplKHtcbiAgICByZXF1aXJlQWxsU2lnbmF0dXJlczogZmFsc2UsXG4gICAgdmVyaWZ5U2lnbmF0dXJlczogZmFsc2UsXG4gIH0pLnRvU3RyaW5nKCdiYXNlNjQnKTtcblxuICByZXR1cm4ge1xuICAgIHRyYW5zYWN0aW9uLFxuICAgIHNlcmlhbGl6ZWRUeCxcbiAgICBtYXJrZXRQZGE6IG1hcmtldFBkYS50b0Jhc2U1OCgpLFxuICAgIG1hcmtldElkLFxuICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQlVJTEQgQ1JFQVRFIFBSSVZBVEUgTUFSS0VUIFRSQU5TQUNUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGRDcmVhdGVQcml2YXRlTWFya2V0VHJhbnNhY3Rpb24oXG4gIHBhcmFtczogQ3JlYXRlUHJpdmF0ZU1hcmtldFBhcmFtcyxcbiAgY29ubmVjdGlvbj86IENvbm5lY3Rpb25cbik6IFByb21pc2U8Q3JlYXRlTWFya2V0UmVzdWx0PiB7XG4gIGNvbnN0IGNvbm4gPSBjb25uZWN0aW9uIHx8IG5ldyBDb25uZWN0aW9uKFJQQ19FTkRQT0lOVCwgJ2NvbmZpcm1lZCcpO1xuICBjb25zdCBjcmVhdG9yUHVia2V5ID0gbmV3IFB1YmxpY0tleShwYXJhbXMuY3JlYXRvcldhbGxldCk7XG5cbiAgY29uc3QgeyBtYXJrZXRJZCB9ID0gYXdhaXQgZ2V0TmV4dE1hcmtldElkKGNvbm4pO1xuICBjb25zdCBbbWFya2V0UGRhXSA9IGRlcml2ZU1hcmtldFBkYShtYXJrZXRJZCk7XG4gIGNvbnN0IFt3aGl0ZWxpc3RQZGFdID0gZGVyaXZlV2hpdGVsaXN0UGRhKG1hcmtldElkKTtcbiAgY29uc3QgW2NyZWF0b3JQcm9maWxlUGRhXSA9IGRlcml2ZUNyZWF0b3JQcm9maWxlUGRhKGNyZWF0b3JQdWJrZXkpO1xuXG4gIGNvbnN0IGNyZWF0b3JQcm9maWxlSW5mbyA9IGF3YWl0IGNvbm4uZ2V0QWNjb3VudEluZm8oY3JlYXRvclByb2ZpbGVQZGEpO1xuICBjb25zdCBoYXNDcmVhdG9yUHJvZmlsZSA9IGNyZWF0b3JQcm9maWxlSW5mbyAhPT0gbnVsbDtcblxuICBjb25zdCBjbG9zaW5nVGltZSA9IEJpZ0ludChNYXRoLmZsb29yKHBhcmFtcy5jbG9zaW5nVGltZS5nZXRUaW1lKCkgLyAxMDAwKSk7XG4gIGNvbnN0IHJlc29sdXRpb25CdWZmZXIgPSBCaWdJbnQocGFyYW1zLnJlc29sdXRpb25CdWZmZXIgPz8gNDMyMDApO1xuICBjb25zdCBhdXRvU3RvcEJ1ZmZlciA9IEJpZ0ludChwYXJhbXMuYXV0b1N0b3BCdWZmZXIgPz8gMzAwKTtcbiAgY29uc3QgcmVzb2x1dGlvbk1vZGUgPSBwYXJhbXMucmVzb2x1dGlvbk1vZGUgPz8gMDsgLy8gSG9zdE9yYWNsZSBmb3IgcHJpdmF0ZVxuXG4gIGNvbnN0IGNvdW5jaWwgPSBwYXJhbXMuY291bmNpbD8ubWFwKHAgPT4gbmV3IFB1YmxpY0tleShwKSkgPz8gW107XG4gIGNvbnN0IGNvdW5jaWxUaHJlc2hvbGQgPSBwYXJhbXMuY291bmNpbFRocmVzaG9sZCA/PyAwO1xuXG4gIC8vIFNhbWUgaW5zdHJ1Y3Rpb24gZm9ybWF0IGFzIExhYiBtYXJrZXRcbiAgY29uc3QgcXVlc3Rpb25CeXRlcyA9IEJ1ZmZlci5mcm9tKHBhcmFtcy5xdWVzdGlvbiwgJ3V0ZjgnKTtcbiAgY29uc3Qgc2l6ZSA9IDggKyA0ICsgcXVlc3Rpb25CeXRlcy5sZW5ndGggKyA4ICsgOCArIDggKyAxICsgNCArIChjb3VuY2lsLmxlbmd0aCAqIDMyKSArIDE7XG5cbiAgY29uc3QgZGF0YSA9IEJ1ZmZlci5hbGxvYyhzaXplKTtcbiAgbGV0IG9mZnNldCA9IDA7XG5cbiAgQ1JFQVRFX1BSSVZBVEVfVEFCTEVfU09MX0RJU0NSSU1JTkFUT1IuY29weShkYXRhLCBvZmZzZXQpOyBvZmZzZXQgKz0gODtcbiAgZGF0YS53cml0ZVVJbnQzMkxFKHF1ZXN0aW9uQnl0ZXMubGVuZ3RoLCBvZmZzZXQpOyBvZmZzZXQgKz0gNDtcbiAgcXVlc3Rpb25CeXRlcy5jb3B5KGRhdGEsIG9mZnNldCk7IG9mZnNldCArPSBxdWVzdGlvbkJ5dGVzLmxlbmd0aDtcbiAgZGF0YS53cml0ZUJpZ0ludDY0TEUoY2xvc2luZ1RpbWUsIG9mZnNldCk7IG9mZnNldCArPSA4O1xuICBkYXRhLndyaXRlQmlnSW50NjRMRShyZXNvbHV0aW9uQnVmZmVyLCBvZmZzZXQpOyBvZmZzZXQgKz0gODtcbiAgZGF0YS53cml0ZUJpZ0ludDY0TEUoYXV0b1N0b3BCdWZmZXIsIG9mZnNldCk7IG9mZnNldCArPSA4O1xuICBkYXRhLndyaXRlVUludDgocmVzb2x1dGlvbk1vZGUsIG9mZnNldCk7IG9mZnNldCArPSAxO1xuICBkYXRhLndyaXRlVUludDMyTEUoY291bmNpbC5sZW5ndGgsIG9mZnNldCk7IG9mZnNldCArPSA0O1xuICBmb3IgKGNvbnN0IG1lbWJlciBvZiBjb3VuY2lsKSB7XG4gICAgbWVtYmVyLnRvQnVmZmVyKCkuY29weShkYXRhLCBvZmZzZXQpOyBvZmZzZXQgKz0gMzI7XG4gIH1cbiAgZGF0YS53cml0ZVVJbnQ4KGNvdW5jaWxUaHJlc2hvbGQsIG9mZnNldCk7XG5cbiAgLy8gUHJpdmF0ZSBtYXJrZXQgYWNjb3VudHMgaW5jbHVkZSB3aGl0ZWxpc3QgUERBXG4gIGNvbnN0IGtleXMgPSBbXG4gICAgeyBwdWJrZXk6IENPTkZJR19QREEsIGlzU2lnbmVyOiBmYWxzZSwgaXNXcml0YWJsZTogdHJ1ZSB9LFxuICAgIHsgcHVia2V5OiBtYXJrZXRQZGEsIGlzU2lnbmVyOiBmYWxzZSwgaXNXcml0YWJsZTogdHJ1ZSB9LFxuICAgIHsgcHVia2V5OiB3aGl0ZWxpc3RQZGEsIGlzU2lnbmVyOiBmYWxzZSwgaXNXcml0YWJsZTogdHJ1ZSB9LFxuICAgIHsgcHVia2V5OiBDT05GSUdfVFJFQVNVUlksIGlzU2lnbmVyOiBmYWxzZSwgaXNXcml0YWJsZTogdHJ1ZSB9LFxuICAgIHsgcHVia2V5OiBjcmVhdG9yUHVia2V5LCBpc1NpZ25lcjogdHJ1ZSwgaXNXcml0YWJsZTogdHJ1ZSB9LFxuICAgIHsgcHVia2V5OiBoYXNDcmVhdG9yUHJvZmlsZSA/IGNyZWF0b3JQcm9maWxlUGRhIDogUFJPR1JBTV9JRCwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiBoYXNDcmVhdG9yUHJvZmlsZSB9LFxuICAgIHsgcHVia2V5OiBTeXN0ZW1Qcm9ncmFtLnByb2dyYW1JZCwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiBmYWxzZSB9LFxuICBdO1xuXG4gIGNvbnN0IGluc3RydWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uSW5zdHJ1Y3Rpb24oe1xuICAgIHByb2dyYW1JZDogUFJPR1JBTV9JRCxcbiAgICBrZXlzLFxuICAgIGRhdGEsXG4gIH0pO1xuXG4gIGNvbnN0IHRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKCk7XG4gIHRyYW5zYWN0aW9uLmFkZChpbnN0cnVjdGlvbik7XG5cbiAgY29uc3QgeyBibG9ja2hhc2ggfSA9IGF3YWl0IGNvbm4uZ2V0TGF0ZXN0QmxvY2toYXNoKCdmaW5hbGl6ZWQnKTtcbiAgdHJhbnNhY3Rpb24ucmVjZW50QmxvY2toYXNoID0gYmxvY2toYXNoO1xuICB0cmFuc2FjdGlvbi5mZWVQYXllciA9IGNyZWF0b3JQdWJrZXk7XG5cbiAgY29uc3Qgc2VyaWFsaXplZFR4ID0gdHJhbnNhY3Rpb24uc2VyaWFsaXplKHtcbiAgICByZXF1aXJlQWxsU2lnbmF0dXJlczogZmFsc2UsXG4gICAgdmVyaWZ5U2lnbmF0dXJlczogZmFsc2UsXG4gIH0pLnRvU3RyaW5nKCdiYXNlNjQnKTtcblxuICByZXR1cm4ge1xuICAgIHRyYW5zYWN0aW9uLFxuICAgIHNlcmlhbGl6ZWRUeCxcbiAgICBtYXJrZXRQZGE6IG1hcmtldFBkYS50b0Jhc2U1OCgpLFxuICAgIG1hcmtldElkLFxuICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQlVJTEQgQ1JFQVRFIFJBQ0UgTUFSS0VUIFRSQU5TQUNUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGRDcmVhdGVSYWNlTWFya2V0VHJhbnNhY3Rpb24oXG4gIHBhcmFtczogQ3JlYXRlUmFjZU1hcmtldFBhcmFtcyxcbiAgY29ubmVjdGlvbj86IENvbm5lY3Rpb25cbik6IFByb21pc2U8Q3JlYXRlTWFya2V0UmVzdWx0PiB7XG4gIGNvbnN0IGNvbm4gPSBjb25uZWN0aW9uIHx8IG5ldyBDb25uZWN0aW9uKFJQQ19FTkRQT0lOVCwgJ2NvbmZpcm1lZCcpO1xuICBjb25zdCBjcmVhdG9yUHVia2V5ID0gbmV3IFB1YmxpY0tleShwYXJhbXMuY3JlYXRvcldhbGxldCk7XG5cbiAgY29uc3QgeyByYWNlTWFya2V0SWQgfSA9IGF3YWl0IGdldE5leHRNYXJrZXRJZChjb25uKTtcbiAgY29uc3QgW3JhY2VNYXJrZXRQZGFdID0gZGVyaXZlUmFjZU1hcmtldFBkYShyYWNlTWFya2V0SWQpO1xuICBjb25zdCBbY3JlYXRvclByb2ZpbGVQZGFdID0gZGVyaXZlQ3JlYXRvclByb2ZpbGVQZGEoY3JlYXRvclB1YmtleSk7XG5cbiAgY29uc3QgY3JlYXRvclByb2ZpbGVJbmZvID0gYXdhaXQgY29ubi5nZXRBY2NvdW50SW5mbyhjcmVhdG9yUHJvZmlsZVBkYSk7XG4gIGNvbnN0IGhhc0NyZWF0b3JQcm9maWxlID0gY3JlYXRvclByb2ZpbGVJbmZvICE9PSBudWxsO1xuXG4gIGNvbnN0IGNsb3NpbmdUaW1lID0gQmlnSW50KE1hdGguZmxvb3IocGFyYW1zLmNsb3NpbmdUaW1lLmdldFRpbWUoKSAvIDEwMDApKTtcbiAgY29uc3QgcmVzb2x1dGlvbkJ1ZmZlciA9IEJpZ0ludChwYXJhbXMucmVzb2x1dGlvbkJ1ZmZlciA/PyA0MzIwMCk7XG4gIGNvbnN0IGF1dG9TdG9wQnVmZmVyID0gQmlnSW50KHBhcmFtcy5hdXRvU3RvcEJ1ZmZlciA/PyAzMDApO1xuICBjb25zdCBsYXllciA9IHBhcmFtcy5sYXllciA/PyAxOyAvLyBMYWIgYnkgZGVmYXVsdFxuICBjb25zdCByZXNvbHV0aW9uTW9kZSA9IHBhcmFtcy5yZXNvbHV0aW9uTW9kZSA/PyAxOyAvLyBDb3VuY2lsT3JhY2xlXG4gIGNvbnN0IGFjY2Vzc0dhdGUgPSBwYXJhbXMuYWNjZXNzR2F0ZSA/PyAwOyAvLyBQdWJsaWNcblxuICAvLyBDb3VuY2lsIGlzIE9wdGlvbjxWZWM8UHVia2V5Pj4gLSBlbmNvZGUgYXMgMSAoU29tZSkgKyB2ZWMgb3IgMCAoTm9uZSlcbiAgY29uc3QgaGFzQ291bmNpbCA9IHBhcmFtcy5jb3VuY2lsICYmIHBhcmFtcy5jb3VuY2lsLmxlbmd0aCA+IDA7XG4gIGNvbnN0IGNvdW5jaWwgPSBoYXNDb3VuY2lsID8gcGFyYW1zLmNvdW5jaWwhLm1hcChwID0+IG5ldyBQdWJsaWNLZXkocCkpIDogW107XG5cbiAgLy8gY291bmNpbF90aHJlc2hvbGQgaXMgT3B0aW9uPHU4PlxuICBjb25zdCBoYXNUaHJlc2hvbGQgPSBwYXJhbXMuY291bmNpbFRocmVzaG9sZCAhPT0gdW5kZWZpbmVkO1xuICBjb25zdCBjb3VuY2lsVGhyZXNob2xkID0gcGFyYW1zLmNvdW5jaWxUaHJlc2hvbGQgPz8gMDtcblxuICAvLyBFbmNvZGUgaW5zdHJ1Y3Rpb24gZGF0YTpcbiAgLy8gZGlzY3JpbWluYXRvciAoOCkgKyBxdWVzdGlvbiAoNCtsZW4pICsgb3V0Y29tZV9sYWJlbHMgKDQgKyBuKig0K2xlbikpICtcbiAgLy8gY2xvc2luZ190aW1lICg4KSArIHJlc29sdXRpb25fYnVmZmVyICg4KSArIGF1dG9fc3RvcF9idWZmZXIgKDgpICtcbiAgLy8gbGF5ZXIgKDEpICsgcmVzb2x1dGlvbl9tb2RlICgxKSArIGFjY2Vzc19nYXRlICgxKSArXG4gIC8vIGNvdW5jaWwgKDEgKyA0ICsgbiozMiBvciBqdXN0IDEpICsgY291bmNpbF90aHJlc2hvbGQgKDEgKyAxIG9yIGp1c3QgMSlcblxuICBjb25zdCBxdWVzdGlvbkJ5dGVzID0gQnVmZmVyLmZyb20ocGFyYW1zLnF1ZXN0aW9uLCAndXRmOCcpO1xuICBjb25zdCBvdXRjb21lQnVmZmVycyA9IHBhcmFtcy5vdXRjb21lcy5tYXAobyA9PiBCdWZmZXIuZnJvbShvLCAndXRmOCcpKTtcblxuICBsZXQgb3V0Y29tZXNTaXplID0gNDsgLy8gdmVjIGxlbmd0aFxuICBmb3IgKGNvbnN0IGJ1ZiBvZiBvdXRjb21lQnVmZmVycykge1xuICAgIG91dGNvbWVzU2l6ZSArPSA0ICsgYnVmLmxlbmd0aDtcbiAgfVxuXG4gIGNvbnN0IGNvdW5jaWxTaXplID0gaGFzQ291bmNpbCA/ICgxICsgNCArIGNvdW5jaWwubGVuZ3RoICogMzIpIDogMTtcbiAgY29uc3QgdGhyZXNob2xkU2l6ZSA9IGhhc1RocmVzaG9sZCA/IDIgOiAxO1xuXG4gIGNvbnN0IHNpemUgPSA4ICsgNCArIHF1ZXN0aW9uQnl0ZXMubGVuZ3RoICsgb3V0Y29tZXNTaXplICsgOCArIDggKyA4ICsgMSArIDEgKyAxICsgY291bmNpbFNpemUgKyB0aHJlc2hvbGRTaXplO1xuICBjb25zdCBkYXRhID0gQnVmZmVyLmFsbG9jKHNpemUpO1xuICBsZXQgb2Zmc2V0ID0gMDtcblxuICBDUkVBVEVfUkFDRV9NQVJLRVRfU09MX0RJU0NSSU1JTkFUT1IuY29weShkYXRhLCBvZmZzZXQpOyBvZmZzZXQgKz0gODtcblxuICBkYXRhLndyaXRlVUludDMyTEUocXVlc3Rpb25CeXRlcy5sZW5ndGgsIG9mZnNldCk7IG9mZnNldCArPSA0O1xuICBxdWVzdGlvbkJ5dGVzLmNvcHkoZGF0YSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IHF1ZXN0aW9uQnl0ZXMubGVuZ3RoO1xuXG4gIGRhdGEud3JpdGVVSW50MzJMRShwYXJhbXMub3V0Y29tZXMubGVuZ3RoLCBvZmZzZXQpOyBvZmZzZXQgKz0gNDtcbiAgZm9yIChjb25zdCBidWYgb2Ygb3V0Y29tZUJ1ZmZlcnMpIHtcbiAgICBkYXRhLndyaXRlVUludDMyTEUoYnVmLmxlbmd0aCwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDQ7XG4gICAgYnVmLmNvcHkoZGF0YSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IGJ1Zi5sZW5ndGg7XG4gIH1cblxuICBkYXRhLndyaXRlQmlnSW50NjRMRShjbG9zaW5nVGltZSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDg7XG4gIGRhdGEud3JpdGVCaWdJbnQ2NExFKHJlc29sdXRpb25CdWZmZXIsIG9mZnNldCk7IG9mZnNldCArPSA4O1xuICBkYXRhLndyaXRlQmlnSW50NjRMRShhdXRvU3RvcEJ1ZmZlciwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDg7XG5cbiAgZGF0YS53cml0ZVVJbnQ4KGxheWVyLCBvZmZzZXQpOyBvZmZzZXQgKz0gMTtcbiAgZGF0YS53cml0ZVVJbnQ4KHJlc29sdXRpb25Nb2RlLCBvZmZzZXQpOyBvZmZzZXQgKz0gMTtcbiAgZGF0YS53cml0ZVVJbnQ4KGFjY2Vzc0dhdGUsIG9mZnNldCk7IG9mZnNldCArPSAxO1xuXG4gIC8vIE9wdGlvbjxWZWM8UHVia2V5Pj4gLSAxIChTb21lKSArIHZlYyBvciAwIChOb25lKVxuICBpZiAoaGFzQ291bmNpbCkge1xuICAgIGRhdGEud3JpdGVVSW50OCgxLCBvZmZzZXQpOyBvZmZzZXQgKz0gMTtcbiAgICBkYXRhLndyaXRlVUludDMyTEUoY291bmNpbC5sZW5ndGgsIG9mZnNldCk7IG9mZnNldCArPSA0O1xuICAgIGZvciAoY29uc3QgbWVtYmVyIG9mIGNvdW5jaWwpIHtcbiAgICAgIG1lbWJlci50b0J1ZmZlcigpLmNvcHkoZGF0YSwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDMyO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBkYXRhLndyaXRlVUludDgoMCwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDE7XG4gIH1cblxuICAvLyBPcHRpb248dTg+IC0gMSAoU29tZSkgKyB2YWx1ZSBvciAwIChOb25lKVxuICBpZiAoaGFzVGhyZXNob2xkKSB7XG4gICAgZGF0YS53cml0ZVVJbnQ4KDEsIG9mZnNldCk7IG9mZnNldCArPSAxO1xuICAgIGRhdGEud3JpdGVVSW50OChjb3VuY2lsVGhyZXNob2xkLCBvZmZzZXQpOyBvZmZzZXQgKz0gMTtcbiAgfSBlbHNlIHtcbiAgICBkYXRhLndyaXRlVUludDgoMCwgb2Zmc2V0KTsgb2Zmc2V0ICs9IDE7XG4gIH1cblxuICAvLyBBY2NvdW50czogY29uZmlnLCByYWNlX21hcmtldCwgY3JlYXRvcl9wcm9maWxlIChvcHRpb25hbCksIHRyZWFzdXJ5LCBjcmVhdG9yLCBzeXN0ZW1fcHJvZ3JhbVxuICBjb25zdCBrZXlzID0gW1xuICAgIHsgcHVia2V5OiBDT05GSUdfUERBLCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IHRydWUgfSxcbiAgICB7IHB1YmtleTogcmFjZU1hcmtldFBkYSwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiB0cnVlIH0sXG4gICAgeyBwdWJrZXk6IGhhc0NyZWF0b3JQcm9maWxlID8gY3JlYXRvclByb2ZpbGVQZGEgOiBQUk9HUkFNX0lELCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IGhhc0NyZWF0b3JQcm9maWxlIH0sXG4gICAgeyBwdWJrZXk6IENPTkZJR19UUkVBU1VSWSwgaXNTaWduZXI6IGZhbHNlLCBpc1dyaXRhYmxlOiB0cnVlIH0sXG4gICAgeyBwdWJrZXk6IGNyZWF0b3JQdWJrZXksIGlzU2lnbmVyOiB0cnVlLCBpc1dyaXRhYmxlOiB0cnVlIH0sXG4gICAgeyBwdWJrZXk6IFN5c3RlbVByb2dyYW0ucHJvZ3JhbUlkLCBpc1NpZ25lcjogZmFsc2UsIGlzV3JpdGFibGU6IGZhbHNlIH0sXG4gIF07XG5cbiAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBuZXcgVHJhbnNhY3Rpb25JbnN0cnVjdGlvbih7XG4gICAgcHJvZ3JhbUlkOiBQUk9HUkFNX0lELFxuICAgIGtleXMsXG4gICAgZGF0YSxcbiAgfSk7XG5cbiAgY29uc3QgdHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24oKTtcbiAgdHJhbnNhY3Rpb24uYWRkKGluc3RydWN0aW9uKTtcblxuICBjb25zdCB7IGJsb2NraGFzaCB9ID0gYXdhaXQgY29ubi5nZXRMYXRlc3RCbG9ja2hhc2goJ2ZpbmFsaXplZCcpO1xuICB0cmFuc2FjdGlvbi5yZWNlbnRCbG9ja2hhc2ggPSBibG9ja2hhc2g7XG4gIHRyYW5zYWN0aW9uLmZlZVBheWVyID0gY3JlYXRvclB1YmtleTtcblxuICBjb25zdCBzZXJpYWxpemVkVHggPSB0cmFuc2FjdGlvbi5zZXJpYWxpemUoe1xuICAgIHJlcXVpcmVBbGxTaWduYXR1cmVzOiBmYWxzZSxcbiAgICB2ZXJpZnlTaWduYXR1cmVzOiBmYWxzZSxcbiAgfSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXG4gIHJldHVybiB7XG4gICAgdHJhbnNhY3Rpb24sXG4gICAgc2VyaWFsaXplZFR4LFxuICAgIG1hcmtldFBkYTogcmFjZU1hcmtldFBkYS50b0Jhc2U1OCgpLFxuICAgIG1hcmtldElkOiByYWNlTWFya2V0SWQsXG4gIH07XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBIRUxQRVI6IERFUklWRSBQREEgUFJFVklFV1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXZpZXdNYXJrZXRQZGEobWFya2V0SWQ6IGJpZ2ludCk6IHtcbiAgbWFya2V0UGRhOiBzdHJpbmc7XG4gIGJ1bXA6IG51bWJlcjtcbn0ge1xuICBjb25zdCBbcGRhLCBidW1wXSA9IGRlcml2ZU1hcmtldFBkYShtYXJrZXRJZCk7XG4gIHJldHVybiB7IG1hcmtldFBkYTogcGRhLnRvQmFzZTU4KCksIGJ1bXAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXZpZXdSYWNlTWFya2V0UGRhKG1hcmtldElkOiBiaWdpbnQpOiB7XG4gIHJhY2VNYXJrZXRQZGE6IHN0cmluZztcbiAgYnVtcDogbnVtYmVyO1xufSB7XG4gIGNvbnN0IFtwZGEsIGJ1bXBdID0gZGVyaXZlUmFjZU1hcmtldFBkYShtYXJrZXRJZCk7XG4gIHJldHVybiB7IHJhY2VNYXJrZXRQZGE6IHBkYS50b0Jhc2U1OCgpLCBidW1wIH07XG59XG4iXX0=